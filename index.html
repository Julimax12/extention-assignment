<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extension Manager</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="dark-theme">
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="header-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="header-text">
                    <h1>Extensions</h1>
                    <p>Manage your browser extensions</p>
                </div>
            </div>
            <div class="header-right">
                <div class="theme-selector">
                    <button class="theme-btn" id="themeBtn">
                        <i class="fas fa-moon"></i>
                        <span class="theme-text">Dark</span>
                    </button>
                    <div class="theme-dropdown" id="themeDropdown">
                        <div class="theme-option" data-theme="light">
                            <i class="fas fa-sun"></i>
                            <span>Light</span>
                        </div>
                        <div class="theme-option" data-theme="dark">
                            <i class="fas fa-moon"></i>
                            <span>Dark</span>
                        </div>
                        <div class="theme-option" data-theme="system">
                            <i class="fas fa-desktop"></i>
                            <span>System</span>
                        </div>
                    </div>
                </div>
                <button class="close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </header>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" placeholder="Search extensions..." class="search-input">
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="filter-tab active" data-filter="all">
                All
                <span class="filter-badge" id="allCount">12</span>
            </button>
            <button class="filter-tab" data-filter="active">
                Active
                <span class="filter-badge" id="activeCount">8</span>
            </button>
            <button class="filter-tab" data-filter="inactive">
                Inactive
                <span class="filter-badge" id="inactiveCount">4</span>
            </button>
        </div>

        <!-- Extensions Grid -->
        <div class="extensions-grid" id="extensionsGrid">
            <!-- Extensions will be dynamically inserted here -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">
                <i class="fas fa-search"></i>
            </div>
            <h3>No extensions found</h3>
            <p id="emptyMessage">No extensions found for the selected filter.</p>
            <button class="clear-search-btn" id="clearSearchBtn">
                Clear search
            </button>
        </div>

        <!-- Stats Footer -->
        <footer class="stats-footer">
            <div class="stat-item">
                <div class="stat-dot active"></div>
                <span id="activeStatCount">8 Active</span>
            </div>
            <div class="stat-item">
                <div class="stat-dot inactive"></div>
                <span id="inactiveStatCount">4 Inactive</span>
            </div>
            <div class="stat-item">
                <div class="stat-dot total"></div>
                <span id="totalStatCount">12 Total Extensions</span>
            </div>
        </footer>
    </div>

    <!-- Extension Details Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-container">
            <div class="modal-header">
                <div class="modal-title-section">
                    <div class="modal-extension-icon" id="modalIcon"></div>
                    <div>
                        <h2 class="modal-title" id="modalTitle">Extension Name</h2>
                        <p class="modal-subtitle" id="modalSubtitle">Category • Version 1.0.0</p>
                    </div>
                </div>
                <button class="modal-close-btn" id="modalCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-content">
                <!-- Extension Status -->
                <div class="modal-section">
                    <div class="section-header">
                        <h3>Status</h3>
                        <div class="extension-toggle modal-toggle" id="modalToggle">
                        </div>
                    </div>
                    <div class="status-info">
                        <div class="status-indicator" id="modalStatusIndicator">
                            <div class="status-dot" id="modalStatusDot"></div>
                            <span class="status-text" id="modalStatusText">Active</span>
                        </div>
                        <p class="status-description" id="modalStatusDescription">
                            This extension is currently active and running.
                        </p>
                    </div>
                </div>

                <!-- Extension Description -->
                <div class="modal-section">
                    <h3>Description</h3>
                    <p class="extension-full-description" id="modalDescription">
                        Full extension description will appear here...
                    </p>
                </div>

                <!-- Extension Details -->
                <div class="modal-section">
                    <h3>Details</h3>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Version</span>
                            <span class="detail-value" id="modalVersion">1.0.0</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Category</span>
                            <span class="detail-value" id="modalCategory">Developer Tools</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Size</span>
                            <span class="detail-value" id="modalSize">2.4 MB</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Last Updated</span>
                            <span class="detail-value" id="modalLastUpdated">2 days ago</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Developer</span>
                            <span class="detail-value" id="modalDeveloper">Extension Developer</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Rating</span>
                            <div class="rating-stars" id="modalRating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                                <span class="rating-text">4.5 (1,234)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Permissions -->
                <div class="modal-section">
                    <h3>Permissions</h3>
                    <div class="permissions-list" id="modalPermissions">
                        <!-- Permissions will be dynamically added -->
                    </div>
                </div>

                <!-- Settings -->
                <div class="modal-section">
                    <h3>Settings</h3>
                    <div class="settings-list" id="modalSettings">
                        <!-- Settings will be dynamically added -->
                    </div>
                </div>

                <!-- Usage Statistics -->
                <div class="modal-section">
                    <h3>Usage Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="modalUsageTime">24h</div>
                            <div class="stat-label">Active Time Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="modalUsageCount">156</div>
                            <div class="stat-label">Times Used This Week</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="modalDataSaved">2.3MB</div>
                            <div class="stat-label">Data Processed</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalRemoveBtn">
                    <i class="fas fa-trash-alt"></i>
                    Remove Extension
                </button>
                <div class="modal-footer-right">
                    <button class="btn btn-outline" id="modalOptionsBtn">
                        <i class="fas fa-cog"></i>
                        Options
                    </button>
                    <button class="btn btn-primary" id="modalSaveBtn">
                        <i class="fas fa-save"></i>
                        Save Changes
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Extension data
const extensionsData = [
  {
      id: "devlens",
      name: "DevLens",
      description: "Quickly inspect page layouts and CSS properties with advanced debugging tools and real-time element analysis",
      fullDescription: "DevLens is a comprehensive developer tool that provides advanced page inspection capabilities. It allows developers to quickly analyze CSS properties, debug layout issues, and understand the structure of web pages. With real-time element analysis, you can hover over any element to see its computed styles, dimensions, and positioning information. The extension also includes features for measuring distances between elements, checking color contrast ratios, and validating accessibility standards.",
      icon: "🔍",
      isActive: true,
      color: "background: linear-gradient(135deg, #3b82f6, #1d4ed8)",
      category: "Developer Tools",
      version: "2.1.4",
      size: "1.8 MB",
      lastUpdated: "3 days ago",
      developer: "DevTools Inc.",
      rating: 4.8,
      ratingCount: 2156,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Read and change all your data on all websites" },
          { icon: "fas fa-eye", title: "Read browsing history", description: "Access your browsing history to provide contextual information" },
          { icon: "fas fa-download", title: "Manage downloads", description: "View and manage your downloads" }
      ],
      settings: [
          { id: "autoInspect", title: "Auto-inspect on hover", description: "Automatically show element details when hovering", type: "toggle", value: true },
          { id: "showDimensions", title: "Show element dimensions", description: "Display width and height information", type: "toggle", value: true },
          { id: "colorFormat", title: "Color format", description: "Choose how colors are displayed", type: "select", value: "hex", options: ["hex", "rgb", "hsl"] }
      ],
      stats: {
          activeTime: "18h",
          usageCount: 342,
          dataProcessed: "4.2MB"
      }
  },
  {
      id: "stylespy",
      name: "StyleSpy",
      description: "Instantly analyze and copy CSS from any web element with one-click extraction and formatting",
      fullDescription: "StyleSpy revolutionizes the way developers work with CSS by providing instant analysis and extraction capabilities. Simply click on any element to view its complete CSS properties, copy specific styles, or export entire stylesheets. The extension features intelligent CSS optimization, duplicate detection, and the ability to generate clean, production-ready code. Perfect for reverse engineering designs, learning from other websites, or quickly prototyping new layouts.",
      icon: "🎨",
      isActive: true,
      color: "background: linear-gradient(135deg, #8b5cf6, #7c3aed)",
      category: "Developer Tools",
      version: "1.9.2",
      size: "2.1 MB",
      lastUpdated: "1 week ago",
      developer: "CSS Masters",
      rating: 4.6,
      ratingCount: 1834,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Read and modify CSS on all websites" },
          { icon: "fas fa-clipboard", title: "Access clipboard", description: "Copy CSS styles to your clipboard" }
      ],
      settings: [
          { id: "autoFormat", title: "Auto-format CSS", description: "Automatically format extracted CSS", type: "toggle", value: true },
          { id: "includeVendor", title: "Include vendor prefixes", description: "Add browser-specific prefixes", type: "toggle", value: false },
          { id: "cssUnit", title: "Preferred CSS unit", description: "Default unit for measurements", type: "select", value: "px", options: ["px", "rem", "em", "%"] }
      ],
      stats: {
          activeTime: "12h",
          usageCount: 198,
          dataProcessed: "1.7MB"
      }
  },
  {
      id: "speedboost",
      name: "SpeedBoost",
      description: "Optimizes browser resource usage to boost your page speed and improve overall performance",
      fullDescription: "SpeedBoost is a powerful performance optimization extension that automatically enhances your browsing experience by managing system resources, blocking unnecessary scripts, and optimizing page loading times. It features intelligent caching, image compression, and script optimization to deliver faster page loads and smoother browsing.",
      icon: "⚡",
      isActive: false,
      color: "background: linear-gradient(135deg, #f97316, #ea580c)",
      category: "Performance",
      version: "3.2.1",
      size: "1.2 MB",
      lastUpdated: "5 days ago",
      developer: "Speed Labs",
      rating: 4.3,
      ratingCount: 892,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Optimize content on all websites" },
          { icon: "fas fa-memory", title: "Manage system resources", description: "Monitor and optimize memory usage" }
      ],
      settings: [
          { id: "autoOptimize", title: "Auto-optimize pages", description: "Automatically optimize page loading", type: "toggle", value: false },
          { id: "blockAds", title: "Block advertisements", description: "Block ads to improve performance", type: "toggle", value: true }
      ],
      stats: {
          activeTime: "0h",
          usageCount: 0,
          dataProcessed: "0MB"
      }
  },
  {
      id: "jsonwizard",
      name: "JSONWizard",
      description: "Beautify and validate JSON documents in browser with syntax highlighting and error detection",
      fullDescription: "JSONWizard is the ultimate JSON manipulation tool for developers. It provides real-time JSON validation, beautiful syntax highlighting, and powerful formatting capabilities. Whether you're debugging APIs, working with configuration files, or learning JSON structure, JSONWizard makes it easy with its intuitive interface and comprehensive error reporting.",
      icon: "📋",
      isActive: true,
      color: "background: linear-gradient(135deg, #ec4899, #db2777)",
      category: "Developer Tools",
      version: "1.5.8",
      size: "0.9 MB",
      lastUpdated: "1 day ago",
      developer: "JSON Tools Co.",
      rating: 4.7,
      ratingCount: 1456,
      permissions: [
          { icon: "fas fa-clipboard", title: "Access clipboard", description: "Read and write JSON data to clipboard" }
      ],
      settings: [
          { id: "autoValidate", title: "Auto-validate JSON", description: "Validate JSON as you type", type: "toggle", value: true },
          { id: "indentSize", title: "Indentation size", description: "Number of spaces for indentation", type: "select", value: "2", options: ["2", "4", "8"] }
      ],
      stats: {
          activeTime: "6h",
          usageCount: 89,
          dataProcessed: "0.8MB"
      }
  },
  {
      id: "taskmaster",
      name: "TaskMaster Pro",
      description: "Organize and manage tasks with groups and deadlines, featuring smart notifications and progress tracking",
      fullDescription: "TaskMaster Pro is a comprehensive task management solution that helps you stay organized and productive. With features like task grouping, deadline tracking, smart notifications, and progress visualization, it's perfect for managing both personal and professional projects. The extension syncs across devices and integrates with popular productivity tools.",
      icon: "📝",
      isActive: true,
      color: "background: linear-gradient(135deg, #6366f1, #4f46e5)",
      category: "Productivity",
      version: "2.8.3",
      size: "3.1 MB",
      lastUpdated: "2 weeks ago",
      developer: "Productivity Plus",
      rating: 4.5,
      ratingCount: 3421,
      permissions: [
          { icon: "fas fa-bell", title: "Show notifications", description: "Display task reminders and notifications" },
          { icon: "fas fa-sync", title: "Sync data", description: "Synchronize tasks across devices" }
      ],
      settings: [
          { id: "notifications", title: "Enable notifications", description: "Show task reminders", type: "toggle", value: true },
          { id: "syncInterval", title: "Sync frequency", description: "How often to sync data", type: "select", value: "5min", options: ["1min", "5min", "15min", "1hour"] }
      ],
      stats: {
          activeTime: "45h",
          usageCount: 567,
          dataProcessed: "12.3MB"
      }
  },
  {
      id: "viewportbuddy",
      name: "ViewportBuddy",
      description: "Responsive design testing with device simulation and real-time viewport resizing capabilities",
      fullDescription: "ViewportBuddy is an essential tool for web developers and designers working on responsive websites. It provides accurate device simulation, real-time viewport resizing, and comprehensive testing tools for ensuring your designs work perfectly across all screen sizes and devices. Features include preset device dimensions, custom breakpoints, and screenshot capture.",
      icon: "📱",
      isActive: false,
      color: "background: linear-gradient(135deg, #06b6d4, #0891b2)",
      category: "Developer Tools",
      version: "1.7.2",
      size: "2.3 MB",
      lastUpdated: "4 days ago",
      developer: "Responsive Design Co.",
      rating: 4.4,
      ratingCount: 1123,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Test responsive design on all websites" },
          { icon: "fas fa-camera", title: "Capture screenshots", description: "Take screenshots of different viewport sizes" }
      ],
      settings: [
          { id: "showRulers", title: "Show rulers", description: "Display measurement rulers", type: "toggle", value: false },
          { id: "defaultDevice", title: "Default device", description: "Default device for testing", type: "select", value: "iPhone", options: ["iPhone", "iPad", "Android", "Desktop"] }
      ],
      stats: {
          activeTime: "0h",
          usageCount: 0,
          dataProcessed: "0MB"
      }
  },
  {
      id: "markupnotes",
      name: "Markup Notes",
      description: "Add sticky notes and annotations directly to web pages with collaborative sharing features",
      fullDescription: "Markup Notes transforms any webpage into a collaborative workspace where you can add sticky notes, highlights, and annotations. Perfect for research, feedback collection, and team collaboration. Notes are saved locally and can be shared with team members. The extension supports rich text formatting, color coding, and organization by projects.",
      icon: "📌",
      isActive: true,
      color: "background: linear-gradient(135deg, #2563eb, #1d4ed8)",
      category: "Productivity",
      version: "1.3.6",
      size: "1.6 MB",
      lastUpdated: "6 days ago",
      developer: "Note Makers",
      rating: 4.2,
      ratingCount: 789,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Add notes to any website" },
          { icon: "fas fa-share", title: "Share data", description: "Share notes with other users" }
      ],
      settings: [
          { id: "autoSave", title: "Auto-save notes", description: "Automatically save notes as you type", type: "toggle", value: true },
          { id: "noteColor", title: "Default note color", description: "Default color for new notes", type: "select", value: "yellow", options: ["yellow", "blue", "green", "pink"] }
      ],
      stats: {
          activeTime: "23h",
          usageCount: 234,
          dataProcessed: "5.7MB"
      }
  },
  {
      id: "gridguides",
      name: "GridGuides",
      description: "Overlay responsive grid guides and rulers on any webpage for precise design alignment",
      fullDescription: "GridGuides is a precision design tool that overlays customizable grid systems and rulers on any webpage. Essential for designers and developers who need pixel-perfect alignment and consistent spacing. Features include multiple grid types, custom breakpoints, measurement tools, and alignment guides that help create professional, well-structured layouts.",
      icon: "⊞",
      isActive: false,
      color: "background: linear-gradient(135deg, #6b7280, #4b5563)",
      category: "Design",
      version: "2.1.0",
      size: "1.4 MB",
      lastUpdated: "1 week ago",
      developer: "Design Grid Pro",
      rating: 4.6,
      ratingCount: 567,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Overlay grids on any website" }
      ],
      settings: [
          { id: "gridType", title: "Grid type", description: "Type of grid to display", type: "select", value: "12-column", options: ["12-column", "16-column", "Custom"] },
          { id: "showRulers", title: "Show rulers", description: "Display measurement rulers", type: "toggle", value: false }
      ],
      stats: {
          activeTime: "0h",
          usageCount: 0,
          dataProcessed: "0MB"
      }
  },
  {
      id: "palettepicker",
      name: "Palette Picker",
      description: "Extract and save color palettes from any webpage with automatic color harmony suggestions",
      fullDescription: "Palette Picker is a designer's dream tool for color extraction and palette creation. Simply hover over any element to capture its colors, or let the extension automatically generate harmonious color schemes from entire webpages. Features include color format conversion, palette saving, export options, and integration with popular design tools.",
      icon: "🎨",
      isActive: true,
      color: "background: linear-gradient(135deg, #10b981, #059669)",
      category: "Design",
      version: "1.8.4",
      size: "2.0 MB",
      lastUpdated: "3 days ago",
      developer: "Color Studio",
      rating: 4.7,
      ratingCount: 1892,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Extract colors from any website" },
          { icon: "fas fa-clipboard", title: "Access clipboard", description: "Copy color codes to clipboard" }
      ],
      settings: [
          { id: "colorFormat", title: "Color format", description: "Preferred color format", type: "select", value: "hex", options: ["hex", "rgb", "hsl", "cmyk"] },
          { id: "autoExtract", title: "Auto-extract colors", description: "Automatically extract dominant colors", type: "toggle", value: true }
      ],
      stats: {
          activeTime: "15h",
          usageCount: 156,
          dataProcessed: "3.2MB"
      }
  },
  {
      id: "linkchecker",
      name: "LinkChecker",
      description: "Scan and validate broken links on any page with comprehensive reporting and fix suggestions",
      fullDescription: "LinkChecker is a comprehensive link validation tool that scans webpages for broken links, redirects, and accessibility issues. It provides detailed reports with fix suggestions and helps maintain website quality. Perfect for SEO professionals, web developers, and content managers who need to ensure all links are working properly.",
      icon: "🔗",
      isActive: true,
      color: "background: linear-gradient(135deg, #d97706, #b45309)",
      category: "SEO Tools",
      version: "2.3.1",
      size: "1.7 MB",
      lastUpdated: "2 days ago",
      developer: "SEO Tools Inc.",
      rating: 4.4,
      ratingCount: 1234,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Check links on any website" },
          { icon: "fas fa-download", title: "Download reports", description: "Save link check reports" }
      ],
      settings: [
          { id: "checkExternal", title: "Check external links", description: "Validate external website links", type: "toggle", value: true },
          { id: "reportFormat", title: "Report format", description: "Format for exported reports", type: "select", value: "csv", options: ["csv", "json", "pdf"] }
      ],
      stats: {
          activeTime: "8h",
          usageCount: 67,
          dataProcessed: "2.1MB"
      }
  },
  {
      id: "domsnapshot",
      name: "DOM Snapshot",
      description: "Capture and save DOM structure for debugging with version comparison and change tracking",
      fullDescription: "DOM Snapshot is a powerful debugging tool that captures and preserves the DOM structure of web pages for analysis and comparison. It's invaluable for tracking changes, debugging dynamic content, and understanding how pages evolve over time. Features include version comparison, change highlighting, and export capabilities for team collaboration.",
      icon: "📸",
      isActive: false,
      color: "background: linear-gradient(135deg, #14b8a6, #0d9488)",
      category: "Developer Tools",
      version: "1.6.7",
      size: "2.8 MB",
      lastUpdated: "1 week ago",
      developer: "Debug Masters",
      rating: 4.3,
      ratingCount: 678,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Capture DOM from any website" },
          { icon: "fas fa-save", title: "Save snapshots", description: "Store DOM snapshots locally" }
      ],
      settings: [
          { id: "autoCapture", title: "Auto-capture changes", description: "Automatically capture DOM changes", type: "toggle", value: false },
          { id: "maxSnapshots", title: "Max snapshots", description: "Maximum number of snapshots to keep", type: "select", value: "10", options: ["5", "10", "25", "50"] }
      ],
      stats: {
          activeTime: "0h",
          usageCount: 0,
          dataProcessed: "0MB"
      }
  },
  {
      id: "consoleplus",
      name: "ConsolePlus",
      description: "Enhanced developer console with advanced debugging and logging capabilities plus custom filters",
      fullDescription: "ConsolePlus supercharges the browser's developer console with advanced features like custom filters, enhanced logging, performance monitoring, and debugging tools. It provides a more powerful and user-friendly debugging experience with features like log grouping, search functionality, and export capabilities for better development workflow.",
      icon: "💻",
      isActive: true,
      color: "background: linear-gradient(135deg, #10b981, #047857)",
      category: "Developer Tools",
      version: "3.1.2",
      size: "2.5 MB",
      lastUpdated: "4 days ago",
      developer: "Console Experts",
      rating: 4.8,
      ratingCount: 2341,
      permissions: [
          { icon: "fas fa-globe", title: "Access your data for all websites", description: "Enhance console on all websites" },
          { icon: "fas fa-bug", title: "Debug applications", description: "Access debugging information" }
      ],
      settings: [
          { id: "enhancedLogging", title: "Enhanced logging", description: "Enable advanced logging features", type: "toggle", value: true },
          { id: "logLevel", title: "Log level", description: "Minimum log level to display", type: "select", value: "info", options: ["debug", "info", "warn", "error"] }
      ],
      stats: {
          activeTime: "32h",
          usageCount: 445,
          dataProcessed: "8.9MB"
      }
  }
];

// State management
let extensions = [...extensionsData];
let currentFilter = "all";
let searchQuery = "";
let currentTheme = "dark";
let currentModalExtension = null;

// DOM elements
const extensionsGrid = document.getElementById("extensionsGrid");
const searchInput = document.getElementById("searchInput");
const filterTabs = document.querySelectorAll(".filter-tab");
const emptyState = document.getElementById("emptyState");
const emptyMessage = document.getElementById("emptyMessage");
const clearSearchBtn = document.getElementById("clearSearchBtn");
const themeBtn = document.getElementById("themeBtn");
const themeDropdown = document.getElementById("themeDropdown");
const modalOverlay = document.getElementById("modalOverlay");
const modalCloseBtn = document.getElementById("modalCloseBtn");
const modalToggle = document.getElementById("modalToggle");
const modalRemoveBtn = document.getElementById("modalRemoveBtn");
const modalSaveBtn = document.getElementById("modalSaveBtn");
const modalOptionsBtn = document.getElementById("modalOptionsBtn");

// Initialize the app
document.addEventListener("DOMContentLoaded", () => {
  initializeTheme();
  renderExtensions();
  updateCounts();
  setupEventListeners();
});

// Theme management
function initializeTheme() {
  const savedTheme = localStorage.getItem("theme") || "dark";
  setTheme(savedTheme);
}

function setTheme(theme) {
  currentTheme = theme;
  localStorage.setItem("theme", theme);

  // Apply theme to body
  document.body.className = theme === "light" ? "light-theme" : "dark-theme";

  // Update theme button
  const themeIcon = themeBtn.querySelector("i");
  const themeText = themeBtn.querySelector(".theme-text");

  switch (theme) {
      case "light":
          themeIcon.className = "fas fa-sun";
          themeText.textContent = "Light";
          break;
      case "dark":
          themeIcon.className = "fas fa-moon";
          themeText.textContent = "Dark";
          break;
      case "system":
          themeIcon.className = "fas fa-desktop";
          themeText.textContent = "System";
          break;
  }
}

// Event listeners
function setupEventListeners() {
  // Search functionality
  searchInput.addEventListener("input", handleSearch);

  // Filter tabs
  filterTabs.forEach((tab) => {
      tab.addEventListener("click", () => handleFilterChange(tab.dataset.filter));
  });

  // Clear search button
  clearSearchBtn.addEventListener("click", clearSearch);

  // Theme selector
  themeBtn.addEventListener("click", toggleThemeDropdown);

  // Theme options
  document.querySelectorAll(".theme-option").forEach((option) => {
      option.addEventListener("click", () => {
          setTheme(option.dataset.theme);
          hideThemeDropdown();
      });
  });

  // Close theme dropdown when clicking outside
  document.addEventListener("click", (e) => {
      if (!e.target.closest(".theme-selector")) {
          hideThemeDropdown();
      }
  });

  // Close button
  document.querySelector(".close-btn").addEventListener("click", () => {
      console.log("Close extension manager");
  });

  // Modal event listeners
  modalCloseBtn.addEventListener("click", closeModal);
  modalOverlay.addEventListener("click", (e) => {
      if (e.target === modalOverlay) {
          closeModal();
      }
  });

  modalToggle.addEventListener("click", () => {
      if (currentModalExtension) {
          toggleExtension(currentModalExtension.id);
          updateModalToggle();
      }
  });

  modalRemoveBtn.addEventListener("click", () => {
      if (currentModalExtension) {
          removeExtension(currentModalExtension.id);
          closeModal();
      }
  });

  modalSaveBtn.addEventListener("click", saveModalSettings);
  modalOptionsBtn.addEventListener("click", openExtensionOptions);

  // ESC key to close modal
  document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
          hideThemeDropdown();
          closeModal();
      }
  });
}

function toggleThemeDropdown() {
  themeDropdown.classList.toggle("show");
}

function hideThemeDropdown() {
  themeDropdown.classList.remove("show");
}

function handleSearch(e) {
  searchQuery = e.target.value.toLowerCase();
  renderExtensions();
}

function handleFilterChange(filter) {
  currentFilter = filter;

  // Update active tab
  filterTabs.forEach((tab) => {
      tab.classList.toggle("active", tab.dataset.filter === filter);
  });

  renderExtensions();
}

function clearSearch() {
  searchQuery = "";
  searchInput.value = "";
  renderExtensions();
}

// Extension management
function toggleExtension(id) {
  const extension = extensions.find((ext) => ext.id === id);
  if (extension) {
      extension.isActive = !extension.isActive;
      renderExtensions();
      updateCounts();
  }
}

function removeExtension(id) {
  extensions = extensions.filter((ext) => ext.id !== id);
  renderExtensions();
  updateCounts();
}

// Rendering functions
function renderExtensions() {
  const filteredExtensions = getFilteredExtensions();

  if (filteredExtensions.length === 0) {
      showEmptyState();
      return;
  }

  hideEmptyState();

  extensionsGrid.innerHTML = filteredExtensions
      .map(
          (extension) => `
      <div class="extension-card" data-id="${extension.id}" onclick="openModal('${extension.id}')">
          <div class="extension-header">
              <div class="extension-info">
                  <div class="extension-icon" style="${extension.color}">
                      ${extension.icon}
                  </div>
                  <div class="extension-details">
                      <h3>${extension.name}</h3>
                      <div class="extension-category">${extension.category}</div>
                  </div>
              </div>
              <div class="extension-toggle ${extension.isActive ? "active" : ""}" 
                   onclick="event.stopPropagation(); toggleExtension('${extension.id}')"
                   tabindex="0"
                   role="switch"
                   aria-checked="${extension.isActive}"
                   aria-label="Toggle ${extension.name}">
              </div>
          </div>
          <p class="extension-description">${extension.description}</p>
          <div class="extension-footer">
              <button class="remove-btn" onclick="event.stopPropagation(); removeExtension('${extension.id}')" aria-label="Remove ${extension.name}">
                  <i class="fas fa-trash-alt"></i>
                  Remove
              </button>
              <div class="extension-status">
                  <div class="status-dot ${extension.isActive ? "active" : "inactive"}"></div>
                  <span class="status-text ${extension.isActive ? "active" : "inactive"}">
                      ${extension.isActive ? "Active" : "Inactive"}
                  </span>
              </div>
          </div>
      </div>
  `,
      )
      .join("");

  // Add keyboard support for toggles
  document.querySelectorAll(".extension-toggle").forEach((toggle) => {
      toggle.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              e.stopPropagation();
              toggle.click();
          }
      });
  });
}

function getFilteredExtensions() {
  let filtered = extensions;

  // Apply search filter
  if (searchQuery) {
      filtered = filtered.filter(
          (ext) =>
              ext.name.toLowerCase().includes(searchQuery) ||
              ext.description.toLowerCase().includes(searchQuery) ||
              ext.category.toLowerCase().includes(searchQuery),
      );
  }

  // Apply status filter
  switch (currentFilter) {
      case "active":
          return filtered.filter((ext) => ext.isActive);
      case "inactive":
          return filtered.filter((ext) => !ext.isActive);
      default:
          return filtered;
  }
}

function showEmptyState() {
  extensionsGrid.style.display = "none";
  emptyState.style.display = "block";

  if (searchQuery) {
      emptyMessage.textContent = `No extensions match "${searchQuery}". Try adjusting your search terms.`;
      clearSearchBtn.style.display = "inline-block";
  } else {
      emptyMessage.textContent = "No extensions found for the selected filter.";
      clearSearchBtn.style.display = "none";
  }
}

function hideEmptyState() {
  extensionsGrid.style.display = "grid";
  emptyState.style.display = "none";
}

function updateCounts() {
  const totalCount = extensions.length;
  const activeCount = extensions.filter((ext) => ext.isActive).length;
  const inactiveCount = totalCount - activeCount;

  // Update filter badges
  document.getElementById("allCount").textContent = totalCount;
  document.getElementById("activeCount").textContent = activeCount;
  document.getElementById("inactiveCount").textContent = inactiveCount;

  // Update stats footer
  document.getElementById("activeStatCount").textContent = `${activeCount} Active`;
  document.getElementById("inactiveStatCount").textContent = `${inactiveCount} Inactive`;
  document.getElementById("totalStatCount").textContent = `${totalCount} Total Extensions`;
}

// Modal functions
function openModal(extensionId) {
  const extension = extensions.find((ext) => ext.id === extensionId);
  if (!extension) return;

  currentModalExtension = extension;
  populateModal(extension);
  modalOverlay.classList.add("show");
  document.body.style.overflow = "hidden";
}

function closeModal() {
  modalOverlay.classList.remove("show");
  document.body.style.overflow = "";
  currentModalExtension = null;
}

function populateModal(extension) {
  // Header
  document.getElementById("modalIcon").style.cssText = extension.color;
  document.getElementById("modalIcon").textContent = extension.icon;
  document.getElementById("modalTitle").textContent = extension.name;
  document.getElementById("modalSubtitle").textContent = `${extension.category} • Version ${extension.version}`;

  // Status
  updateModalToggle();

  // Description
  document.getElementById("modalDescription").textContent = extension.fullDescription || extension.description;

  // Details
  document.getElementById("modalVersion").textContent = extension.version;
  document.getElementById("modalCategory").textContent = extension.category;
  document.getElementById("modalSize").textContent = extension.size;
  document.getElementById("modalLastUpdated").textContent = extension.lastUpdated;
  document.getElementById("modalDeveloper").textContent = extension.developer;

  // Rating
  const ratingContainer = document.getElementById("modalRating");
  const fullStars = Math.floor(extension.rating);
  const hasHalfStar = extension.rating % 1 !== 0;

  let starsHTML = "";
  for (let i = 0; i < fullStars; i++) {
      starsHTML += '<i class="fas fa-star"></i>';
  }
  if (hasHalfStar) {
      starsHTML += '<i class="fas fa-star-half-alt"></i>';
  }
  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
  for (let i = 0; i < emptyStars; i++) {
      starsHTML += '<i class="far fa-star"></i>';
  }
  starsHTML += `<span class="rating-text">${extension.rating} (${extension.ratingCount.toLocaleString()})</span>`;
  ratingContainer.innerHTML = starsHTML;

  // Permissions
  const permissionsContainer = document.getElementById("modalPermissions");
  permissionsContainer.innerHTML = extension.permissions
      .map(
          (permission) => `
      <div class="permission-item">
        <div class="permission-icon">
          <i class="${permission.icon}"></i>
        </div>
        <div class="permission-info">
          <div class="permission-title">${permission.title}</div>
          <div class="permission-description">${permission.description}</div>
        </div>
      </div>
    `,
      )
      .join("");

  // Settings
  const settingsContainer = document.getElementById("modalSettings");
  settingsContainer.innerHTML = extension.settings
      .map((setting) => {
          let controlHTML = "";
          if (setting.type === "toggle") {
              controlHTML = `<div class="setting-toggle ${setting.value ? "active" : ""}" onclick="toggleSetting('${setting.id}')"></div>`;
          } else if (setting.type === "select") {
              controlHTML = `
              <select class="setting-select" onchange="updateSetting('${setting.id}', this.value)">
                ${setting.options.map((option) => `<option value="${option}" ${option === setting.value ? "selected" : ""}>${option}</option>`).join("")}
              </select>
            `;
          }

          return `
            <div class="setting-item">
              <div class="setting-info">
                <div class="setting-title">${setting.title}</div>
                <div class="setting-description">${setting.description}</div>
              </div>
              <div class="setting-control">
                ${controlHTML}
              </div>
            </div>
          `;
      })
      .join("");

  // Usage Statistics
  document.getElementById("modalUsageTime").textContent = extension.stats.activeTime;
  document.getElementById("modalUsageCount").textContent = extension.stats.usageCount;
  document.getElementById("modalDataSaved").textContent = extension.stats.dataProcessed;
}

function updateModalToggle() {
  if (!currentModalExtension) return;

  const toggle = document.getElementById("modalToggle");
  const statusDot = document.getElementById("modalStatusDot");
  const statusText = document.getElementById("modalStatusText");
  const statusDescription = document.getElementById("modalStatusDescription");

  toggle.classList.toggle("active", currentModalExtension.isActive);
  statusDot.classList.toggle("active", currentModalExtension.isActive);
  statusDot.classList.toggle("inactive", !currentModalExtension.isActive);
  statusText.classList.toggle("active", currentModalExtension.isActive);
  statusText.classList.toggle("inactive", !currentModalExtension.isActive);
  statusText.textContent = currentModalExtension.isActive ? "Active" : "Inactive";
  statusDescription.textContent = currentModalExtension.isActive
      ? "This extension is currently active and running."
      : "This extension is currently disabled.";
}

function toggleSetting(settingId) {
  if (!currentModalExtension) return;

  const setting = currentModalExtension.settings.find((s) => s.id === settingId);
  if (setting && setting.type === "toggle") {
      setting.value = !setting.value;

      // Update the toggle visual state
      const toggleElement = document.querySelector(`[onclick="toggleSetting('${settingId}')"]`);
      toggleElement.classList.toggle("active", setting.value);
  }
}

function updateSetting(settingId, value) {
  if (!currentModalExtension) return;

  const setting = currentModalExtension.settings.find((s) => s.id === settingId);
  if (setting) {
      setting.value = value;
  }
}

function saveModalSettings() {
  if (!currentModalExtension) return;

  console.log("Saving settings for", currentModalExtension.name, currentModalExtension.settings);

  // Show a brief success message
  const saveBtn = document.getElementById("modalSaveBtn");
  const originalText = saveBtn.innerHTML;
  saveBtn.innerHTML = '<i class="fas fa-check"></i> Saved!';
  saveBtn.style.background = "var(--success-color)";

  setTimeout(() => {
      saveBtn.innerHTML = originalText;
      saveBtn.style.background = "";
  }, 2000);
}

function openExtensionOptions() {
  if (!currentModalExtension) return;

  console.log("Opening options for", currentModalExtension.name);
  alert(`Opening options page for ${currentModalExtension.name}`);
}

// Keyboard navigation
document.addEventListener("keydown", (e) => {
  // Ctrl/Cmd + F to focus search
  if ((e.ctrlKey || e.metaKey) && e.key === "f") {
      e.preventDefault();
      searchInput.focus();
  }
});

// Add smooth scrolling for better UX
document.documentElement.style.scrollBehavior = "smooth";

    </script>
  </body>
</html>